
## How to bind

To bind an Obj-C library (or framework), it should be included in a iOS binding project, with a valid mapping of its methods in the `ApiDefinition.cs` and `Structs.cs` files and the project should be built.
To generate the initial `ApiDefinitions.cs` and `Structs.cs` files, run `sharpie` on the library, then manually fix build errors as they appear. See below for how to fix the most common errors.
As of the 23rd of Oct 2018, the only way to use sharpie found to be working, is to run it neither on the `.a` nor the `.framework` of the library, but on the source code itself (sigh).
The commad that got us bootstrapped in sharpie is:
```bash
sharpie bind -namespace NearIT ~/YOUR-DEV-PATH/ios-sdk/NearITSDK/*.h -sdk iphoneos12.2 -scope ~/YOUR-DEV-PATH/ios-sdk/NearITSDK
```
### Sharpie generation error:

```
Unhandled Exception:
System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---> Sharpie.Tooling.Tool+ExitException: Exception of type 'Sharpie.Tooling.Tool+ExitException' was thrown.
  at Sharpie.ParseTool+ParseOptionSection.SetTargetSdk (System.String sdkIdentifier) [0x0004a] in /Users/builder/vsts/_work/2/s/Sharpie/ParseTool.cs:55 
```
Make sure to use the latest installed ios sdk version in the command at "iphoneosXX.X"

## Info and other approaches

https://debruyn.dev/2016/creating-a-xamarin.ios-binding-project-for-dummies/

## Fixing automatic binding errors

Looking at the Xamarin-SDK repository `ApiDefinition.cs` and `Structs.cs` you can gather some info on how to fix the code generated by sharpie by examining the diff of certain commits.

- All methods with a [Verify(MethodToProperty)] are usually generated correctly, we can comment the warning line.
- All [Verify(ConstantsInterfaceAssociation)] blocks are ususally generated correctly, so we can comment the warning line
- All (except for the first) definitions of `Constants` will warn. We can comment out [Static] for all of them (except for the first).
- Some methods will not build because the return value will not be compatible with `TValue` or some error like that. In that case add 
```c#
: INativeObject
```
to the definition of that object in the `ApiDefinitions.cs`.

- Some classes implementing protocols will appear to implement a version of the protocol that starts with **I** like **INITValidating**, this can be edited to **NITValidating**
- Some methods with `{ get; }` will complain, they might be fixed with `()` instead of `{ get; }` (usually stuff in `NSData_NSDataZip`) (ATTENTION: not fixing this will cause build errors in other files).
- This line
```c#
unsafe Reachability ReachabilityWithAddress (sockaddr* hostAddress);
```
can be commented out
- Warning `StronglyTypedNSArray` cna be commented out
- The line
```c#
byte[] NearITSDKVersionString { get; }
```
can be commented out
- `[Verify (PlatformInvoke)]` can be commented out
- enum extending from nint => make them extend long
